# nvfetcher.toml - all sources managed declaratively
# Run: nvfetcher -o _sources

# mesa-git and dependencies (tracking git HEAD)

[mesa]
src.git = "https://gitlab.freedesktop.org/mesa/mesa.git"
fetch.git = "https://gitlab.freedesktop.org/mesa/mesa.git"

[libdrm]
src.git = "https://gitlab.freedesktop.org/mesa/drm.git"
fetch.git = "https://gitlab.freedesktop.org/mesa/drm.git"

[wayland-protocols]
src.git = "https://gitlab.freedesktop.org/wayland/wayland-protocols.git"
fetch.git = "https://gitlab.freedesktop.org/wayland/wayland-protocols.git"

# proton-cachyos (tracking github releases)
# $ver = "cachyos-10.0-20251222-slr", filename = "proton-$ver-x86_64.tar.xz"

[proton-cachyos]
src.github = "CachyOS/proton-cachyos"
fetch.url = "https://github.com/CachyOS/proton-cachyos/releases/download/$ver/proton-$ver-x86_64.tar.xz"

[proton-cachyos-x86_64-v2]
src.github = "CachyOS/proton-cachyos"
fetch.url = "https://github.com/CachyOS/proton-cachyos/releases/download/$ver/proton-$ver-x86_64_v2.tar.xz"

[proton-cachyos-x86_64-v3]
src.github = "CachyOS/proton-cachyos"
fetch.url = "https://github.com/CachyOS/proton-cachyos/releases/download/$ver/proton-$ver-x86_64_v3.tar.xz"

[proton-cachyos-x86_64-v4]
src.github = "CachyOS/proton-cachyos"
fetch.url = "https://github.com/CachyOS/proton-cachyos/releases/download/$ver/proton-$ver-x86_64_v4.tar.xz"

# Vintage Story
# tracks official modding api and using src.cmd to fetch the latest and stable versions

# Latest - version includes channel and URL prefix
# Looks like: "stable/vs_client_linux-x64_x.xx.x" or "unstable/vs_client_linux-x64_x.xx.x-rc.x"
[vintagestory]
src.cmd = '''
VER=$(curl -s https://mods.vintagestory.at/api/gameversions | jq -r '.gameversions[-1].name')
if echo "$VER" | grep -q '-'; then echo "unstable/vs_client_linux-x64_$VER"; else echo "stable/vs_client_linux-x64_$VER"; fi
'''
fetch.url = "https://cdn.vintagestory.at/gamefiles/$ver.tar.gz"

# Stable - last version without hyphen denoting a release candidate
[vintagestory-stable]
src.cmd = "curl -s https://mods.vintagestory.at/api/gameversions | jq -r '[.gameversions[].name | select(test(\"^[0-9]+[.][0-9]+[.][0-9]+$\"))] | last'"
fetch.url = "https://cdn.vintagestory.at/gamefiles/stable/vs_client_linux-x64_$ver.tar.gz"

# PokeMMO (this URL never changes, but the hash will)

[pokemmo]
src.manual = "latest"
fetch.url = "https://pokemmo.com/download_file/1/"

# Pseudoregalia Randomizer
[pseudoregalia-rando]
src.github = "pseudoregalia-modding/rando"
fetch.url = "https://github.com/pseudoregalia-modding/rando/archive/$ver.tar.gz"

[oodle-lib]
src.manual = "0.2.3"
fetch.url = "https://github.com/new-world-tools/go-oodle/releases/download/v0.2.3-files/liboo2corelinux64.so.9"

# Eden Emulator - nightly
[eden-emulator]
src.git = "https://git.eden-emu.dev/eden-emu/eden.git"
fetch.git = "https://git.eden-emu.dev/eden-emu/eden.git"

# Hytale Launcher
[hytale-launcher]
src.manual = "latest"
fetch.url = "https://launcher.hytale.com/builds/release/linux/amd64/hytale-launcher-latest.zip"
